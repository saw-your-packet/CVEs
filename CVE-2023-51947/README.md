# CVE-2023-51947

## Description

Improper access control on nasSvr.php in actidata actiNAS SL 2U-8 RDX 3.2.03-SP1 allows remote attackers to read and modify different types of data without authentication.

## Affected systems

The web application version 3.2.03-SP1 from actiNAS Plus SL 2U-8 RDX.

Product link: https://www.actidata.com/index.php/de-de/actinas-plus-sl-2u-8-rdx

## Author

Eduard Agavriloae

## Details

The web application through the endpoint /nasSvr.php allows reading and writing operations over multiple types of data unauthenticated.

According to CVE-2023-51948 the web application is vulnerable to a site-wide directory listing vulnerability. Because of this, you can read from the client-side files the structure of the queries required for reading or writing data.

This information can be found in the files under `/app/model`.

For example, we can find at `/app/model/sysMonitor/SysLogm.js` that the endpoint `/nasSvr.php` has a function called `getSysLogList` as it can be seen in the next screenshot: 

![image](https://github.com/saw-your-packet/CVEs/assets/38787278/90e2e0b8-697f-4bea-8db1-d37d7cc107dd)

Even if the client-side code states that the function can be called via POST request, it actually works from GET requests too. If we access the function in question at `/nasSvr.php?func=getSysLogList` we will get the system logs even if we are not authenticated:

![image](https://github.com/saw-your-packet/CVEs/assets/38787278/541d161c-829a-478e-83ee-2e084fb2b30e)

Other operations of interest:

|Endpoint|Details|
|-|-|
|GET /nasSvr.php?func=accountMgr&op=getAccList|Will retrieve list of accounts|
|POST /nasSvr.php?func=accountMgr&op=addAcc|Will create a new management account|
|POST /nasSvr.php?func=accountMgr&op=delAcc|Will delete or update a management account|
|GET /nasSvr.php?func=accountMgr&op=getDirectory|Will retrieve a list of configurations for directories|
|GET /nasSvr.php?func=accountMgr&op=getGroupList|Will retrive a list of user groups|
|GET /nasSvr.php?func=storageMgr&op=getArrayList|Will retrieve a list of disks|
|GET /nasSvr.php?func=storageMgr&op=getPdList|Will retriee a list of partitions|
|GET /nasSvr.php?func=homeMgr&op=getMgrAppList&parent=home|Will return a list of services and their home folder|
|GET /nasSvr.php?func=homeMgr&op=getSearchResult|Will return a list of services and their home folder|
|GET /nasSvr.php?func=homeMgr&op=getQucikInitDefaultSet| Will return the network interface configuration|
|GET /nasSvr.php?func=iscsiMgr&op=getNicList|Will return network interface names and IPs|
|GET /nasSvr.php?func=shareMgr&op=getShareList|Will return list of shares along with permissions and ownership|
|GET /nasSvr.php?func=shareMgr&op=getShareMgrTree|Will return list of shares|
|GET /nasSvr.php?func=getSysInfo|Will return hardware and software versions aong with network details|
|GET /nasSvr.php?func=getNetAdapterList|Will return network adaptors information|
|GET /nasSvr.php?func=storageMgr&op=getLvList&type=free|Will return volumes|

## Other versions

My feeling is that other versions are affected as well, but I didn't found other instances of this product in order to validate.
